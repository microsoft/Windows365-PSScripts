# Windows App Health Check Log Reader 

Health Check in Windows App detects various issues that commonly cause connection problems for users. A nice feature of Health Check is that it creates a log that shows the various checks and their status, but unfortunately there isn't a way at the moment for admins to see the results or read the log. 

This tool provides a way for admins to see if a failure or warning has been generated by Health Check, read what the problem is, and also to obtain the log from Intune. This solution uses [Intune Remediations](https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/remediations) to accomplish the task. 

Remdiations will only work with Windows PCs that are managed by Intune. This will not work for other platforms or unmanaged devices. 

## Detection Script

The detection script will look at the last lines of the script for the last health check that was run. The number of lines is configurable, with the default set to 26 - the current number of lines a health check generates. This number can be modified by changing the value of the variable "$NumOfLines". If the script finds the words "Fail" or "Warning", it will return a state of non-compliance. This status is viewable in the Remediations pane in Intune and will allow Admins to know if Health Check has found an issue. Otherwise, it will return compliant.

## Remediation Script

When the detection script returns a non-compliant state, it will trigger the remediation script. This script will read through the stated number of lines, which is also configurable by modifying the variable "$NumOfLines", and will output each line that contains "Fail" or "Warning". The output is captured by Remediaitons and is viewable by exporting the report. 

The script will also copy the entire health check log (health_checks.log) to the IME logs folder, which will allow admins to copy up the log through Intune. Please note that uploading other logs other than the logs Intune places in that folder is unsupported, but it does work for now. [Click here for more information on how to gather the logs](https://learn.microsoft.com/en-us/intune/intune-service/remote-actions/collect-diagnostics)

## Using Remediations

Remediations allow admins to have a particular package to run at an interval, allowing admins to periodically check if users are encountering an issue. Furthermore, Remediations now allows Admins to run a package on-demand, which should be useful in troubleshooting scenarios.

The script is unsigned, and if your org requires scripts to be signed, you will need to sign the script yourself.

The script requires being run in the system context.

## Disclaimer

This script is provided as-is, without support from Microsoft. Use at your own risk.